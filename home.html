<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>모바일 성경 퀴즈 — 6권 (120문)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 모바일 전용 폭 제한 & 폰트 크기 조정 */
    html,body {height:100%}
    body {background: linear-gradient(180deg,#f8fafc,#eef2ff); -webkit-font-smoothing:antialiased;}
    .app {max-width:720px; margin:0 auto; padding:18px; min-height:100vh; display:flex; flex-direction:column;}
    /* 카드 그림자와 터치 영역 약간 확대 */
    .card {box-shadow:0 6px 24px rgba(8,30,78,0.06);}
    /* 선택지 버튼 터치 영역 키움 */
    .opt-btn {padding-top:14px;padding-bottom:14px;}
    /* 해설 박스 */
    .explain {background:#fff; border-left:4px solid #0ea5e9; padding:12px; border-radius:8px;}
    @media(min-width:420px){
      .app {padding:24px;}
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="mb-4">
      <div class="card bg-white rounded-2xl p-4">
        <h1 class="text-2xl font-semibold text-center">모바일 성경 퀴즈</h1>
        <p class="text-sm text-center text-gray-600 mt-1">사무엘상·사무엘하·에베소서·빌립보서·골로세서·빌레몬서 — 각 20문제, 해설 포함 (총 120문)</p>
      </div>
    </header>

    <main class="flex-1">
      <section class="card bg-white rounded-2xl p-4 mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">퀴즈 책 선택</label>
        <select id="bookSelect" class="w-full rounded-lg border-gray-200 shadow-sm p-3">
          <option value="">-- 선택하세요 --</option>
          <option value="1sam">사무엘상 (1 Samuel)</option>
          <option value="2sam">사무엘하 (2 Samuel)</option>
          <option value="eph">에베소서 (Ephesians)</option>
          <option value="phil">빌립보서 (Philippians)</option>
          <option value="col">골로세서 (Colossians)</option>
          <option value="phm">빌레몬서 (Philemon)</option>
        </select>

        <div class="flex gap-2 mt-4">
          <button id="startBtn" class="flex-1 bg-blue-600 text-white rounded-lg py-3 font-semibold">퀴즈 시작</button>
          <button id="shuffleBtn" class="flex-1 bg-white border border-gray-200 text-gray-700 rounded-lg py-3">섞기</button>
        </div>
      </section>

      <section id="quizArea" class="hidden card bg-white rounded-2xl p-4">
        <div class="flex items-center justify-between mb-3">
          <div class="text-sm text-gray-600" id="bookTitle"></div>
          <div class="text-sm text-gray-600" id="progress">0 / 0</div>
        </div>

        <div id="qCard" class="mb-4">
          <!-- 질문 렌더 -->
        </div>

        <div id="explainBox" class="hidden mb-4 explain text-sm text-gray-700"></div>

        <div class="flex gap-2">
          <button id="nextBtn" class="flex-1 bg-green-600 text-white rounded-lg py-3 font-semibold" disabled>다음</button>
          <button id="quitBtn" class="flex-1 bg-red-50 text-red-600 rounded-lg py-3 border border-red-100">종료</button>
        </div>
      </section>

      <section id="resultArea" class="hidden card bg-white rounded-2xl p-4 mt-4">
        <div class="text-center mb-3">
          <div class="text-lg font-bold" id="finalScore"></div>
          <div class="text-sm text-gray-600" id="finalMsg"></div>
        </div>
        <div>
          <button id="reviewBtn" class="w-full bg-blue-600 text-white rounded-lg py-3 mb-2">정답/해설 보기</button>
          <button id="restartBtn" class="w-full bg-white border border-gray-200 rounded-lg py-3">다시 시작</button>
        </div>
      </section>

      <section id="reviewArea" class="hidden card bg-white rounded-2xl p-4 mt-4">
        <h3 class="font-semibold mb-3">정답 및 해설</h3>
        <div id="reviewList" class="space-y-3 max-h-[52vh] overflow-auto pr-2"></div>
        <div class="mt-3">
          <button id="closeReviewBtn" class="w-full bg-gray-100 rounded-lg py-3">닫기</button>
        </div>
      </section>
    </main>

    <footer class="mt-4 text-center text-xs text-gray-500">
      파일을 저장하여 휴대폰에서 열면 오프라인에서도 동작합니다.
    </footer>
  </div>

<script>
/*
  구조:
    - booksData: 각 책별 20문제 (question, options[4], answer(숫자), explain(해설))
    - UI: 책 선택 -> 시작 -> 문제별 선택 -> 즉시 피드백+해설 -> 다음 -> 최종 결과 -> 리뷰
*/

// ---------- 문제 데이터 (각 책 당 20문) ----------
// 설명: 문제는 한국어로, 보기 4개, 정답은 0-based 인덱스, explain에 간단 해설
const booksData = {
  '1sam': {
    title: '사무엘상',
    questions: [
      { question:"사무엘의 어머니 이름은 무엇인가요?", options:["미리암","한나","느헤미야","마리아"], answer:1,
        explain:"한나가 아이를 간절히 구한 기도로 사무엘을 낳았고, 사무엘은 하나님의 선지자가 되었습니다." },
      { question:"사무엘이 어린 시절 섬기던 제사장의 이름은?", options:["엘리","아론","사독","아비아달"], answer:0,
        explain:"사무엘은 엘리 제사장의 집에서 자라며 하나님의 음성을 들었습니다." },
      { question:"이스라엘의 첫 번째 왕으로 기름부음을 받은 사람은?", options:["다윗","사울","솔로몬","아합"], answer:1,
        explain:"백성이 왕을 요구하자 하나님은 사울을 왕으로 세우셨습니다." },
      { question:"사무엘상이 주로 다루는 시기는 어느 시대인가요?", options:["압제기","왕정 시작기","바벨론 포로기","교회 시대"], answer:1,
        explain:"사무엘상은 사무엘과 사울, 다윗 초기의 이야기로 왕정이 시작되는 시기를 다룹니다." },
      { question:"사무엘이 어린 시절 '네 종이 듣나이다'라고 응답한 대상은 누구인가요?", options:["엘리","사울","다윗","솔로몬"], answer:0,
        explain:"하나님의 음성을 엘리 제사장의 조언으로 구분하고 응답했습니다." },
      { question:"하나님께서 사울을 버리신 주된 이유로 나오지 않는 것은?", options:["아말렉을 완전히 진멸치 않음","거짓 예언","제사 규례 불순종","교만"], answer:1,
        explain:"성경의 주요 이유는 하나님의 명령(아말렉 진멸 불이행)과 제사 규례 불순종 등이며, 거짓 예언은 본문에서 핵심 이유로 제시되지 않습니다." },
      { question:"다윗이 골리앗을 물리칠 때 사용한 도구는?", options:["검","창","물맷돌과 투석기","활"], answer:2,
        explain:"다윗은 물맷돌(슬링의 돌)을 사용해 골리앗을 쓰러뜨렸습니다." },
      { question:"사울이 왕으로 선출된 지파는 어디인가요?", options:["베냐민","유다","에브라임","스불론"], answer:0,
        explain:"사울은 베냐민 지파 출신입니다." },
      { question:"사무엘상에서 사울과 다윗 관계의 핵심 감정은 무엇인가요?", options:["우정","시기와 갈등","무관심","형제애"], answer:1,
        explain:"사울은 다윗을 시기하며 여러 차례 그의 생명을 노렸습니다." },
      { question:"사무엘상에서 사무엘의 직업은 무엇인가요?", options:["왕","제사장 겸 선지자","제사장만","법관"], answer:1,
        explain:"사무엘은 제사장으로 섬기다가 하나님의 선지자적 역할을 수행했습니다." },
      { question:"사무엘상에서 백성이 왕을 요구한 이유로 성경에 나타나지 않는 것은?", options:["다른 나라처럼 되길 원함","사무엘의 아들들이 악행함","사무엘이 원해서","전쟁의 필요"], answer:2,
        explain:"백성은 왕을 요구했으나 그 주된 동기는 '다른 나라처럼 되려 함'과 지도력의 안정 등이며 사무엘의 요청은 아니었습니다." },
      { question:"사울이 하나님의 명령 대신 자신의 뜻대로 행한 대표적 사건은?", options:["예배 드림","아말렉 진멸의 불순종","언약궤 운반","다윗 기름부음"], answer:1,
        explain:"사울은 아말렉을 완전히 멸하지 않고 좋은 짐승을 남겨 하나님의 명령을 어겼습니다." },
      { question:"사무엘상이 끝날 즈음 주로 묘사되는 것은?", options:["사울의 몰락","다윗의 죽음","솔로몬의 왕위","이스라엘의 포로"], answer:0,
        explain:"사무엘상은 사울의 실패와 다윗의 부상을 중심으로 마무리됩니다." },
      { question:"사무엘이 이스라엘에게 '왕을 요구한 것'을 어떻게 보았나요?", options:["기뻐함","슬퍼함","무관심","분노"], answer:1,
        explain:"사무엘은 백성의 요청을 슬퍼하며 하나님께 나아갔습니다." },
      { question:"사무엘상에서 다윗이 처음으로 등장할 때의 주요 활동은?", options:["왕위 즉위","골리앗과의 전투","선지자 사역","제사 집행"], answer:1,
        explain:"다윗은 골리앗을 물리친 사건으로 처음 주목을 받습니다." },
      { question:"사무엘상에서 사무엘의 주요 역할이 아닌 것은?", options:["선지자","제사장","재판관","왕"], answer:3,
        explain:"사무엘은 왕은 아니었고 선지자·제사장·판단자 역할을 했습니다." },
      { question:"사울과 다윗 사이에 친밀했던 사람은 누구였나?", options:["요나단","요압","나단","사독"], answer:0,
        explain:"요나단(사울의 아들)은 다윗과 깊은 우정을 나누었습니다." },
      { question:"사무엘이 기름을 부어 왕을 세우는 행위는 무엇을 상징하나요?", options:["정치적 계약","하나님의 선택과 성별","군사적 서약","경제적 동맹"], answer:1,
        explain:"기름부음은 하나님의 선택과 거룩한 사명 부여를 의미합니다." },
      { question:"사무엘의 아들들에 대한 기록이 주는 교훈은?", options:["왕권의 영속성","가족의 타락이 지도력에 영향","왕의 신성함","평화의 유지"], answer:1,
        explain:"사무엘의 아들들이 타락함으로 백성이 왕을 요구하는 배경이 되었습니다." }
    ]
  },

  '2sam': {
    title: '사무엘하',
    questions: [
      { question:"사무엘하의 중심 인물은 누구인가요?", options:["사울","다윗","솔로몬","사무엘"], answer:1,
        explain:"사무엘하는 다윗의 통치와 그의 삶(승리·죄·회개)을 중심으로 전개됩니다." },
      { question:"다윗이 밧세바와 범죄했을 때 책망한 선지자는 누구인가요?", options:["사무엘","나단","엘리","예레미야"], answer:1,
        explain:"선지자 나단이 다윗에게 직언하여 다윗이 회개하게 됩니다." },
      { question:"밧세바의 남편 이름은 무엇인가요?", options:["요나단","우리아","요압","사무엘"], answer:1,
        explain:"밧세바의 남편은 우리아로, 다윗은 우리아를 전쟁터에 배치해 죽게 했습니다." },
      { question:"다윗의 장군이자 때로는 문제를 일으킨 인물은?", options:["요압","아브넬","요나단","므비보셋"], answer:0,
        explain:"요압은 다윗의 군사적 활동에서 핵심적이지만 권력 투쟁에도 관여했습니다." },
      { question:"다윗 시대에 예루살렘으로 옮겨온 중요한 성물은?", options:["법궤(언약궤)","검","왕관","성막"], answer:0,
        explain:"언약궤가 예루살렘에 모셔지면서 도시의 종교적 중심이 되었습니다." },
      { question:"압살롬은 다윗에게 어떤 관계인가요?", options:["아들","형제","조카","친구"], answer:0,
        explain:"압살롬은 다윗의 아들로 반역을 일으켜 일시적으로 정권을 장악했습니다." },
      { question:"사무엘하에서 다윗의 인구조사로 인해 일어난 재앙은?", options:["기근","전염병","지진","홍수"], answer:1,
        explain:"다윗의 인구조사로 인해 하나님이 징계로 전염병을 내리셨습니다." },
      { question:"다윗의 치세 중 회개와 용서를 강조한 사건은?", options:["밧세바 사건","골리앗 사건","출애굽","바벨론"], answer:0,
        explain:"밧세바 사건에서 다윗은 선지자 나단의 책망을 받고 회개했습니다." },
      { question:"암다(아비삭)는 다윗의 노년을 왜 돕기 위해 데려왔나?", options:["음식 관리","온기를 주기 위해","전투 지원","예배 보조"], answer:1,
        explain:"아비삭은 다윗을 따뜻하게 하기 위한 역할로 데려와졌습니다." },
      { question:"사무엘하에서 압살롬의 최후는 어떠했나?", options:["사울에게 암살","전투 중 사망","병사로 귀환","유배"], answer:1,
        explain:"압살롬은 전투 중에 나무에 머리가 걸려 요압의 부하에게 살해됩니다." },
      { question:"다윗이 범죄한 후 하나님이 약속한 회복의 표시는 무엇인가?", options:["왕위 유지","즉시 승리","추방","사할 절망"], answer:0,
        explain:"다윗은 죄로 징계를 받지만 왕위는 유지되며 회복과 하나님의 은혜가 나타납니다." },
      { question:"다윗과 요압 사이의 중요한 갈등 원인은 무엇인가?", options:["종교적 견해 차이","요압의 강경 전술과 권력욕","토지 분배","상속 문제"], answer:1,
        explain:"요압은 자신의 군사적 이해관계와 권력욕으로 다윗과 충돌하기도 했습니다." },
      { question:"사무엘하에서 중요한 외교적 행위로 볼 수 있는 것은?", options:["언약궤 이동","다윗의 친구맺기","제사 제도 개선","왕의 결혼"], answer:0,
        explain:"언약궤 이동은 종교적·정치적 통합을 상징합니다." },
      { question:"다윗이 압살롬의 반역 중 보인 반응은?", options:["격렬한 복수","애통과 도망","무관심","행정 강화"], answer:1,
        explain:"다윗은 반역으로 인해 피난하며 큰 슬픔을 겪었습니다." },
      { question:"사무엘하에서 다윗의 통치가 남긴 주요 교훈은?", options:["권력의 영광만","회개의 필요성","무죄성","군사력"], answer:1,
        explain:"다윗의 삶은 위대함과 죄, 회개의 과정을 통해 지도자의 연약함과 회복을 보여줍니다." },
      { question:"다윗이 요압에게 명령하여 처리하려 했던 사건과 실제 결과는?", options:["요압이 복종","요압의 불복종으로 살인 발생","평화적 해결","요압의 죽음"], answer:1,
        explain:"요압은 때로 다윗 명령과 반대로 행동하여 추가적 갈등을 만들었습니다." },
      { question:"사무엘하에서 '왕권의 확립'을 상징하는 사건은?", options:["예루살렘 정복과 언약궤 안치","다윗의 회개","압살롬의 반역","요압의 배신"], answer:0,
        explain:"예루살렘 함락과 언약궤 입성은 다윗 왕국의 종교적·정치적 중심 확립입니다." },
      { question:"다윗이 자신의 죄를 깨닫고 내린 행동은?", options:["회개와 기도","도망","항변","제사장 처벌"], answer:0,
        explain:"다윗은 선지자 나단의 지적 이후 진심으로 회개했습니다." },
      { question:"사무엘하에서 '사랑과 배신'의 대표적 관계는?", options:["다윗-요나단","다윗-압살롬","사무엘-사울","다윗-요압"], answer:1,
        explain:"압살롬은 다윗의 아들이었지만 반역을 통해 배신을 저질렀습니다." }
    ]
  },

  'eph': {
    title: '에베소서',
    questions: [
      { question:"에베소서를 쓴 사람은 누구인가요?", options:["바울","베드로","요한","빌립"], answer:0,
        explain:"사도 바울이 로마 감옥에서 에베소 교회에 보낸 편지입니다." },
      { question:"에베소서에서 교회를 비유한 표현은 무엇인가요?", options:["그리스도의 몸","왕의 군대","무리","제국"], answer:0,
        explain:"교회는 '그리스도의 몸'으로 묘사되어 성도의 연합을 강조합니다." },
      { question:"에베소서 6장의 핵심 비유는 무엇인가요?", options:["전신갑주","양 떼 비유","씨 뿌리는 자","달란트"], answer:0,
        explain:"전신갑주 비유는 영적 전쟁과 성도의 방어를 가르칩니다." },
      { question:"에베소서에서 구원은 무엇으로 주어진다고 말하나요?", options:["행위","은혜로, 믿음으로","육적 혈통","율법 준수"], answer:1,
        explain:"구원은 하나님 은혜로 믿음에 의해 주어진다고 명확히 선언합니다." },
      { question:"에베소서가 강조하는 교회의 핵심은 무엇인가요?", options:["수직적 예배","교회의 일치와 성도의 성숙","부요함","정치적 힘"], answer:1,
        explain:"교회의 연합, 성도의 직무와 성숙이 중요한 주제로 등장합니다." },
      { question:"'한 주, 한 믿음, 한 세례' 구절이 나오는 장은?", options:["2장","3장","4장","5장"], answer:2,
        explain:"에베소서 4장은 교회 일치와 은사에 대해 말합니다." },
      { question:"에베소서에서 성도들에게 권면하는 가정 생활은 어떤 비유로 설명되나요?", options:["그리스도와 교회","왕과 신하","부자와 종","부모와 자녀"], answer:0,
        explain:"남편과 아내의 관계를 그리스도와 교회의 관계에 비유합니다." },
      { question:"에베소서에서 성령의 인치는 무엇을 의미하나요?", options:["성전 건축","구원의 표지(보증)","세례만","예언의 능력"], answer:1,
        explain:"성령의 인침은 구원의 보증(상급을 약속하는 표지)으로 이해됩니다." },
      { question:"에베소서에서 '영적 전쟁'의 상대는 누구로 묘사되나요?", options:["사람들","어둠의 세력","자연","정부"], answer:1,
        explain:"영적 전쟁은 하늘에 있는 악한 세력들과의 싸움으로 설명됩니다." },
      { question:"에베소서의 최종 권면으로 적절한 것은?", options:["무력 사용","전신갑주를 입으라","부유해지라","은밀히 떠나라"], answer:1,
        explain:"바울은 성도들에게 항상 전신갑주를 취하라고 권면합니다." },
      { question:"에베소서에서 교회 안 직분이나 은사를 언급하는 목적은?", options:["특정 사람의 영광","교회의 상호 유익과 성숙","권력 장악","부 축적"], answer:1,
        explain:"은사는 교회를 세우고 성도를 성숙케 하려는 목적입니다." },
      { question:"에베소서의 저자가 자신을 소개할 때 주로 쓰는 표현은?", options:["그리스도의 종","왕의 대리인","그리스도의 갇힌 자","교회의 주"], answer:2,
        explain:"바울은 여러 차례 자신을 '그리스도의 갇힌 자'(or 종)로 소개합니다." },
      { question:"에베소서가 강조하는 성도의 생활 태도는?", options:["세속적 욕망 추구","겸손, 사랑, 인내","권력 추구","고립"], answer:1,
        explain:"겸손과 사랑, 그리고 교회 내 연합을 강조합니다." },
      { question:"에베소서에서 '주로부터 바라는 지혜'는 무엇과 연결되나요?", options:["기도와 계시","부의 축적","인간 지혜","무시"], answer:0,
        explain:"바울은 기도와 성령을 통해 참된 지혜가 주어진다고 말합니다." },
      { question:"교회가 '비밀'로 표현되는 의미는?", options:["비밀 모임","이방인과의 연합을 통한 구원 계획","감춰진 축복","정치적 음모"], answer:1,
        explain:"교회(교회론)는 구원이 유대인뿐 아니라 이방인에게도 확장되는 하나님의 계획을 드러냅니다." },
      { question:"에베소서에서 '사랑 안에서 참을성'을 어떻게 권면하나?", options:["분노 억압","서로 용납하고 사랑으로 참음","침묵","분쟁을 피함"], answer:1,
        explain:"성도는 서로를 사랑으로 용납하며 인내할 것을 가르칩니다." },
      { question:"에베소서에서 '진리의 말씀'은 무엇과 연결되나?", options:["율법 준수","그리스도의 말씀과 교훈","전통","사회적 규범"], answer:1,
        explain:"진리의 말씀은 그리스도의 복음과 교훈을 의미합니다." },
      { question:"전신갑주 중 '믿음의 방패'는 무엇을 막는가?", options:["총과 칼","악한 자의 모든 불화살","병","가난"], answer:1,
        explain:"믿음의 방패는 마귀의 불화살(의심·시험)을 막는 비유적 방패입니다." },
      { question:"에베소서의 주요 청중은 누구였는가?", options:["유대인만","이방인만","다양한 배경의 신자들","로마 군인들"], answer:2,
        explain:"에베소서는 유대인·이방인 포함, 다양한 배경의 신자들에게 교회론과 성도 생활을 가르칩니다." }
    ]
  },

  'phil': {
    title: '빌립보서',
    questions: [
      { question:"빌립보서의 중심 주제는 무엇인가요?", options:["슬픔","기쁨","율법","정의"], answer:1,
        explain:"빌립보서는 '기쁨'을 여러 번 강조하는 편지입니다." },
      { question:"바울이 빌립보서를 쓴 장소는 어디인가요?", options:["로마 감옥","에베소","예루살렘","안디옥"], answer:0,
        explain:"바울은 로마에 갇혀 있을 때 빌립보서 등을 썼습니다." },
      { question:"빌립보서에서 바울이 권하는 그리스도의 본은 무엇인가?", options:["부유함","겸손과 순종","정치력","지식"], answer:1,
        explain:"빌립보서 2장에 나오는 그리스도의 겸손과 순종의 본이 핵심입니다." },
      { question:"'내게 능력 주시는 자 안에서 내가 모든 것을 할 수 있느니라'는 구절의 장·절은?", options:["1장 6절","2장 10절","4장 13절","3장 8절"], answer:2,
        explain:"빌립보서 4장 13절이 유명한 구절입니다." },
      { question:"빌립보서에서 바울이 기뻐하라고 반복하여 권하는 곳은?", options:["1장","2장","3장","4장"], answer:3,
        explain:"빌립보서 4장에서 '기뻐하라'를 다시 권면합니다." },
      { question:"빌립보서에서 바울이 말하는 '자족'의 의미는?", options:["항상 풍족함","모든 환경 속에서 만족함","부 축적","불평"], answer:1,
        explain:"바울은 어떤 상황에서도 자족하는 법을 배웠다고 고백합니다." },
      { question:"빌립보서에서 바울의 동역자 중 빌립보 교회에 특별히 언급된 사람은?", options:["에바브로디도","디모데","디도","루가"], answer:0,
        explain:"에바브로디도는 바울을 도운 사람으로 빌립보서에서 언급됩니다." },
      { question:"빌립보서에서 바울의 근심 대신 권면되는 자세는?", options:["걱정함","기도와 감사","무시","논쟁"], answer:1,
        explain:"바울은 '아무 것도 염려하지 말고 기도와 감사로' 권면합니다." },
      { question:"빌립보서에서 '복음의 진보'에 대해 바울은 어떤 마음을 표현하나?", options:["좌절","기뻐함","무관심","분노"], answer:1,
        explain:"바울은 심지어 옥중에서도 복음이 전파되는 것을 기뻐합니다." },
      { question:"빌립보서의 서신 목적 중 중요한 하나는 무엇인가?", options:["교회 분열 조장","교인들의 재정 지원 감사","무시","전쟁 준비"], answer:1,
        explain:"바울은 빌립보 교회의 후원과 친교에 대해 감사를 표합니다." },
      { question:"빌립보서에서 그리스도의 겸손을 설명하는 구체적 행동은?", options:["천사되심","자기의 권리 포기와 죽음에 이르기까지 복종","승리 선포","재물 축적"], answer:1,
        explain:"예수께서 스스로 낮아져 죽기까지 복종하신 것이 본으로 제시됩니다." },
      { question:"바울은 빌립보서에서 어떤 태도를 '영적 전진'이라 하나?", options:["세속적 성공","겸손과 복종, 복음 중심의 삶","권력 추구","유명세"], answer:1,
        explain:"영적 진전은 복음과 그리스도를 닮는 삶으로 설명됩니다." },
      { question:"빌립보서는 주로 어떤 감정으로 채워져 있나?", options:["절망","기쁨과 감사","분노","두려움"], answer:1,
        explain:"전반적으로 기쁨과 감사가 편지를 관통합니다." },
      { question:"바울이 '네게 임하는 영광'을 기다리라 권하는 이유는 무엇인가?", options:["경제적 보상","하나님과의 연합","세상 명성","정치적 자리"], answer:1,
        explain:"바울은 궁극적 소망이 하나님과의 연합과 영광에 있음을 강조합니다." },
      { question:"빌립보서에서 바울이 보여준 모범적 태도는?", options:["공격성","감사와 관대함","무관심","교만"], answer:1,
        explain:"바울은 상황 속에서도 감사와 만족을 표하며 모범을 보입니다." },
      { question:"빌립보서가 공동체에 요구하는 핵심 실천은?", options:["분쟁 회피","기도와 상호 돌봄","재물 축적","정치 참여"], answer:1,
        explain:"기도와 상호 돌봄, 겸손한 섬김이 강조됩니다." },
      { question:"'그리스도를 아는 지식'에 대해 바울이 추천하는 태도는?", options:["자만","겸손과 헌신","무시","호기심"], answer:1,
        explain:"그리스도를 아는 지식은 삶의 실천으로 연결되어야 한다고 가르칩니다." },
      { question:"빌립보서에서 바울이 강조하는 기도의 자세는?", options:["무계획적 기도","감사와 간구를 함께하는 기도","강요된 기도","비밀스런 의식"], answer:1,
        explain:"바울은 감사와 간구를 함께하는 기도를 권면합니다." },
      { question:"빌립보서에서 바울이 표현한 '내 생명이 무엇보다 귀한 이유'는?", options:["지위","그리스도를 위함","명예","재산"], answer:1,
        explain:"바울은 자신의 생명을 복음과 그리스도를 위해 쓰는 것을 중요시합니다." }
    ]
  },

  'col': {
    title: '골로세서',
    questions: [
      { question:"골로세서를 쓴 사람은 누구인가요?", options:["바울","베드로","야고보","요한"], answer:0,
        explain:"바울이 로마 감옥에서 골로새 교회에 보낸 편지입니다." },
      { question:"골로세서에서 강조하는 핵심 진리는 무엇인가요?", options:["그리스도의 충만함","율법의 세부 규례","제사제 계급","군사 전략"], answer:0,
        explain:"골로세서는 그리스도의 충만함과 그의 주권을 강조합니다." },
      { question:"골로새 교회를 개척하거나 확립한 사람으로 기록된 이는?", options:["에바브라","디모데","바나바","요한"], answer:0,
        explain:"에바브라는 골로새에서 복음을 위해 수고한 동역자로 언급됩니다." },
      { question:"골로세서에서 경계하는 것은 무엇인가?", options:["무조건적 자유","사람의 전통과 세속 철학과 의식주의","선한 행실","기도"], answer:1,
        explain:"바울은 영적 진리를 사람의 철학이나 전통과 혼합하는 것을 경계합니다." },
      { question:"골로세서에서 '새 사람'은 무엇을 의미하나요?", options:["육체적 변화","그리스도를 닮아 갱신된 사람","정치적 입장","경제적 부"], answer:1,
        explain:"새 사람은 그리스도 안에서 새로워진 도덕적·영적 상태를 말합니다." },
      { question:"골로세서에서 그리스도를 무엇으로 묘사하나요?", options:["만물 위에 뛰어나신 분","단순한 선생","예언자","시인"], answer:0,
        explain:"그리스도는 만물 위에 뛰어난 분으로 묘사됩니다." },
      { question:"골로세서가 제시하는 바른 영적 훈련으로 옳지 않은 것은?", options:["기도와 감사","육체 욕심 추구","성도의 권면","그리스도 중심의 삶"], answer:1,
        explain:"육체적 욕심 추구는 골로세서의 가르침에 반합니다." },
      { question:"골로세서에서 '지체를 죽이라'는 권면의 의미는?", options:["사망을 조장","죄된 욕망을 버리고 영적 성장을 이루라","타인을 해치라","포기하라"], answer:1,
        explain:"'지체를 죽이라'는 옛 사람(죄된 본성)을 버리라는 영적 권면입니다." },
      { question:"골로세서에서 자녀 교육에 대해 권면하는 것은 무엇인가?", options:["지배적 훈육","주 안에서 권면과 권위로 양육","방임","과잉 간섭"], answer:1,
        explain:"부모는 주 안에서 사랑과 규율로 자녀를 양육하라고 권면합니다." },
      { question:"골로세서에서 그리스도의 충만함이 주는 실천적 결과는?", options:["자만","겸손, 관용, 사랑","고립","부의 축적"], answer:1,
        explain:"그리스도의 충만함을 경험한 자는 겸손과 관용으로 서로를 대합니다." },
      { question:"골로세서가 반대하는 '이단적 경향'은 무엇인가?", options:["세속 철학과 의식주의의 혼합","기도 생활","선행","성찬"], answer:0,
        explain:"바울은 복음과 상반되는 철학적·의식적 혼합을 경계합니다." },
      { question:"골로세서 3장에서 권면하는 삶의 핵심 덕목 아닌 것은?", options:["자비","겸손","질투","인내"], answer:2,
        explain:"질투는 거세해야 할 것으로, 자비·겸손·인내는 권장되는 덕목입니다." },
      { question:"골로세서에서 기도의 태도는 어떻게 권하나?", options:["무관심","항상 깨어 감사함으로 기도","강요된 식사","침묵"], answer:1,
        explain:"항상 깨어 감사함으로 기도하라는 권면이 나옵니다." },
      { question:"골로세서에서 '세상의 초등학문'으로 경고되는 것은 무엇인가?", options:["그리스도와 충만을 혼동시키는 교리와 규례","기도","찬송","사랑"], answer:0,
        explain:"세상의 초등학문은 복음의 진리와 혼합될 때 위험합니다." },
      { question:"골로세서에서 권면하는 교회의 덕목은?", options:["권력 유지","서로를 용납하고 사랑으로 덮음","부의 축적","경쟁"], answer:1,
        explain:"사랑과 용납, 화목이 강조됩니다." },
      { question:"골로세서에서 그리스도의 역할을 정리하면?", options:["단지 선생","만물의 주관자이자 교회의 머리","제사장만","부자"], answer:1,
        explain:"그리스도는 만물을 다스리시고 교회의 머리이십니다." },
      { question:"골로세서에서 권면하는 '옛 사람과 새 사람'의 관계는?", options:["공존","옛 사람을 버리고 새 사람을 입음","옛 사람 보존","무시"], answer:1,
        explain:"옛 사람을 벗고 새 사람을 입는 변화가 강조됩니다." },
      { question:"골로세서를 통해 얻는 실천적 교훈은 무엇인가?", options:["철학 추구","그리스도 중심의 생활과 실천","부 축적","권력 획득"], answer:1,
        explain:"골로세서는 모든 삶의 영역에서 그리스도 중심적 실천을 요구합니다." },
      { question:"골로세서가 남기는 신학적 핵심은?", options:["그리스도의 보편적 주권과 충만함","인간의 능력","국가의 힘","종교 의식"], answer:0,
        explain:"그리스도의 주권과 충만함이 골로세서의 핵심 신학입니다." }
    ]
  },

  'phm': {
    title: '빌레몬서',
    questions: [
      { question:"빌레몬서의 수신인은 누구인가요?", options:["빌레몬","오네시모","에바브라","바울"], answer:0,
        explain:"빌레몬은 이 편지의 직접적인 수신자이며 지역 교회의 주요 인물입니다." },
      { question:"오네시모는 원래 어떤 신분이었나?", options:["제자","도망친 종","사역자","제사장"], answer:1,
        explain:"오네시모는 빌레몬의 종으로 도망간 후 변화를 겪습니다." },
      { question:"바울이 오네시모를 소개할 때 사용한 표현은?", options:["적","무익한 자","갇힌 중에 낳은 아들","원수"], answer:2,
        explain:"바울은 오네시모를 자신이 갇힌 중에 얻은 아들로 부릅니다(영적 관계 강조)." },
      { question:"빌레몬서의 중심 주제는 무엇인가요?", options:["정의의 복수","용서와 화해","교리 논쟁","상업"], answer:1,
        explain:"이 편지는 개인적 용서와 화해, 형제애 회복을 강조합니다." },
      { question:"바울이 빌레몬에게 부탁한 주된 행동은?", options:["오네시모를 처벌","오네시모를 하나님과 같이 받으라","오네시모를 무시","오네시모를 팔라는"], answer:1,
        explain:"바울은 오네시모를 종이 아닌 형제로 받아줄 것을 간청합니다." },
      { question:"바울이 오네시모의 잘못 비용을 대신 지불하겠다고 말한 의도는?", options:["재정 확답","책임과 화해의 의지 표명","공갈","거절"], answer:1,
        explain:"바울은 오네시모의 잘못을 보상하려는 책임감을 보였습니다." },
      { question:"빌레몬서에서 바울 자신을 어떻게 묘사했나?", options:["젊은 사도","나이 많은 자","무명인","왕"], answer:1,
        explain:"바울은 자신을 '나이 많은 자'로 소개하며 존중을 요청합니다." },
      { question:"빌레몬서의 편지 형식상 특징은 무엇인가?", options:["공식적 서신","매우 개인적이고 권면적","공적 명령서","법적 문서"], answer:1,
        explain:"빌레몬서는 개인적 간청의 문체로 작성되었습니다." },
      { question:"빌레몬이 오네시모를 받아들일 때 기대되는 결과는 무엇인가?", options:["경제적 이득","형제 관계 회복과 교회 내 화목","사회적 제재","군사적 충돌"], answer:1,
        explain:"화해를 통한 공동체 회복이 핵심 목표입니다." },
      { question:"빌레몬서에서 '오네시모'라는 이름의 의미와 관련된 해석은?", options:["유익한 자","무익한 자","영웅","예언자"], answer:0,
        explain:"오네시모는 '유익한'을 의미하며 편지에서 무익한 자가 유익한 자로 변화된 점이 강조됩니다." },
      { question:"빌레몬서가 초점으로 삼는 윤리적 덕목은?", options:["보복","용서와 사랑","거짓말","교만"], answer:1,
        explain:"용서와 사랑, 화해적 관계 회복이 권면됩니다." },
      { question:"바울이 빌레몬에게 공개적으로 권면하지 않고 개인적으로 부탁한 이유는 무엇인가?", options:["공식적 처벌 회피","상대의 체면을 살려 화해를 유도하려 함","무관심","법적문제"], answer:1,
        explain:"바울은 빌레몬의 자발적 용서를 끌어내기 위해 은근한 개인적 권면을 선택했습니다." },
      { question:"빌레몬서에 실린 인간관계 교훈은 오늘날에 주는 메시지는?", options:["법적 복수","용서와 회복의 우선성","권력 추구","외면"], answer:1,
        explain:"개인 간 관계 회복과 용서의 중요성은 현대에도 적용됩니다." },
      { question:"빌레몬서에서 바울이 오네시모를 보낸 이유는?", options:["형제 삼기 위함","처벌 목적으로","판매","노동력 활용"], answer:0,
        explain:"바울은 오네시모를 형제로 받아들여 공동체에 유익하도록 권면합니다." },
      { question:"빌레몬서의 길이는 성경 신약 중 어떤 편에 속하나?", options:["긴 서신","짧은 개인 서신","복음서","역사서"], answer:1,
        explain:"빌레몬서는 매우 짧은 개인 서신 유형에 해당합니다(단 한 장)."},
      { question:"바울이 빌레몬에게 보낸 태도는 어떤 톤인가?", options:["명령적","간청과 사랑의 권면","비난","무시"], answer:1,
        explain:"바울은 간청과 겸손한 권면의 어조로 빌레몬에게 요청합니다." },
      { question:"오네시모가 변화되어 보여준 모습은 무엇인가?", options:["무익에서 유익으로","더 악해짐","무관심","탈주"], answer:0,
        explain:"오네시모는 복음을 통해 변하여 '유익한 자'로 바뀌었습니다." },
      { question:"빌레몬서의 핵심 적용은 교회 내 어떤 관계를 회복시키려는가?", options:["교회-정부","주인-종의 화해와 형제적 관계 회복","국가 간 관계","경제 거래"], answer:1,
        explain:"빌레몬서는 노예 관계를 넘어 형제적 화해를 촉구합니다." },
      { question:"빌레몬서를 통해 드러나는 바울의 리더십 스타일은?", options:["권력적 강압","중재적 사랑과 설득","회피적","독재적"], answer:1,
        explain:"바울은 권위에만 의존하지 않고 사랑·설득·중재로 문제를 해결하려 합니다." }
    ]
  }
};

// ---------- UI 로직 ----------
const bookSelect = document.getElementById('bookSelect');
const startBtn = document.getElementById('startBtn');
const shuffleBtn = document.getElementById('shuffleBtn');
const quizArea = document.getElementById('quizArea');
const bookTitleEl = document.getElementById('bookTitle');
const progressEl = document.getElementById('progress');
const qCard = document.getElementById('qCard');
const explainBox = document.getElementById('explainBox');
const nextBtn = document.getElementById('nextBtn');
const quitBtn = document.getElementById('quitBtn');
const resultArea = document.getElementById('resultArea');
const finalScore = document.getElementById('finalScore');
const finalMsg = document.getElementById('finalMsg');
const reviewBtn = document.getElementById('reviewBtn');
const restartBtn = document.getElementById('restartBtn');
const reviewArea = document.getElementById('reviewArea');
const reviewList = document.getElementById('reviewList');
const closeReviewBtn = document.getElementById('closeReviewBtn');

let currentBookKey = null;
let questions = [];
let index = 0;
let score = 0;
let answersRecord = []; // {q,options,answer,user,correct,explain}

// 시작
startBtn.addEventListener('click', () => {
  const key = bookSelect.value;
  if(!key) { alert('먼저 책을 선택하세요.'); return; }
  startQuiz(key);
});

shuffleBtn.addEventListener('click', () => {
  const key = bookSelect.value;
  if(!key) { alert('먼저 책을 선택하세요.'); return; }
  // 섞기 (선택 불러오기 전에도 가능)
  const arr = (booksData[key].questions || []).slice();
  for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
  booksData[key]._shuffled = arr;
  alert('문제가 섞였습니다. 시작을 눌러주세요.');
});

function startQuiz(key){
  currentBookKey = key;
  const book = booksData[key];
  // prioritize shuffled array if exists
  questions = book._shuffled ? book._shuffled.slice() : (book.questions || []).slice();
  // ensure exactly 20 questions (data already 20 per book)
  if(questions.length > 20) questions = questions.slice(0,20);
  index = 0; score = 0; answersRecord = [];
  // UI
  document.getElementById('bookTitle').textContent = book.title;
  quizArea.classList.remove('hidden');
  resultArea.classList.add('hidden');
  reviewArea.classList.add('hidden');
  renderQuestion();
}

// 질문 렌더
function renderQuestion(){
  explainBox.classList.add('hidden');
  explainBox.innerHTML = '';
  nextBtn.disabled = true;
  const q = questions[index];
  progressEl.textContent = `${index+1} / ${questions.length}`;
  // question card
  qCard.innerHTML = `
    <div class="text-base font-semibold mb-3">${index+1}. ${escapeHtml(q.question)}</div>
    <div class="space-y-2">
      ${q.options.map((opt,i)=>`
        <button class="opt-btn w-full text-left border border-gray-200 rounded-lg opt hover:bg-blue-50 transition" data-i="${i}">
          <div class="px-3">${escapeHtml(String.fromCharCode(65+i))}. ${escapeHtml(opt)}</div>
        </button>
      `).join('')}
    </div>
  `;
  // add listeners
  Array.from(qCard.querySelectorAll('.opt')).forEach(btn=>{
    btn.addEventListener('click', onSelect);
  });
}

// 선택 처리
function onSelect(e){
  const btn = e.currentTarget;
  const sel = parseInt(btn.getAttribute('data-i'));
  const q = questions[index];
  const correct = (sel === q.answer);
  if(correct) { score++; }
  // 기록
  answersRecord.push({
    q: q.question,
    options: q.options.slice(),
    answer: q.answer,
    user: sel,
    correct,
    explain: q.explain
  });
  // UI: 모든 버튼 비활성 및 색상 표시
  Array.from(qCard.querySelectorAll('.opt')).forEach(b=>{
    b.disabled = true;
    b.classList.add('opacity-80');
    const i = parseInt(b.getAttribute('data-i'));
    if(i === q.answer){
      b.classList.add('border-2','border-green-300','bg-green-50');
    }
    if(i === sel && i !== q.answer){
      b.classList.add('border-2','border-red-300','bg-red-50');
    }
  });
  // 해설 표시
  explainBox.innerHTML = `
    <div class="font-medium mb-1">${correct ? '정답입니다 🎉' : '아쉽습니다 ✖️'}</div>
    <div class="text-sm text-gray-700">${escapeHtml(q.explain)}</div>
  `;
  explainBox.classList.remove('hidden');
  nextBtn.disabled = false;
  // 마지막이면 다음 대신 결과 버튼으로
  if(index === questions.length - 1){
    nextBtn.textContent = '결과 보기';
  } else {
    nextBtn.textContent = '다음';
  }
}

// 다음 버튼
nextBtn.addEventListener('click', () => {
  if(index < questions.length - 1){
    index++;
    renderQuestion();
    // 스크롤 상단으로
    window.scrollTo({top:0,behavior:'smooth'});
  } else {
    // 결과 표시
    showResult();
  }
});

// 종료 버튼
quitBtn.addEventListener('click', () => {
  if(confirm('퀴즈를 종료하고 처음으로 돌아가시겠습니까?')) location.reload();
});

// 결과
function showResult(){
  quizArea.classList.add('hidden');
  resultArea.classList.remove('hidden');
  finalScore.textContent = `점수: ${score} / ${questions.length}`;
  const pct = Math.round(score / questions.length * 100);
  let msg = '';
  if(pct === 100) msg = '완벽합니다! 모든 문제 정답입니다.';
  else if(pct >= 80) msg = '잘 하셨습니다! 거의 완벽해요.';
  else if(pct >= 50) msg = '좋아요. 복습하면 더 좋아집니다.';
  else msg = '더 공부해봐요. 해설을 잘 읽고 다시 도전하세요.';
  finalMsg.textContent = msg;
}

// 리뷰 보기
reviewBtn.addEventListener('click', () => {
  resultArea.classList.add('hidden');
  reviewArea.classList.remove('hidden');
  renderReview();
});

restartBtn.addEventListener('click', () => { location.reload(); });

closeReviewBtn.addEventListener('click', () => {
  reviewArea.classList.add('hidden');
  resultArea.classList.remove('hidden');
});

function renderReview(){
  reviewList.innerHTML = '';
  answersRecord.forEach((r, idx)=>{
    const div = document.createElement('div');
    div.className = 'p-3 border border-gray-100 rounded-lg';
    const userOpt = r.user != null ? String.fromCharCode(65 + r.user) : '(무응답)';
    const correctOpt = String.fromCharCode(65 + r.answer);
    div.innerHTML = `
      <div class="font-medium mb-1">${idx+1}. ${escapeHtml(r.q)}</div>
      <div class="text-sm text-gray-700 mb-2">
        내 답: <span class="${r.correct ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}">${escapeHtml(userOpt)}</span>
        &nbsp; 정답: <span class="font-semibold">${escapeHtml(correctOpt)}</span>
      </div>
      <div class="text-sm text-gray-700">${escapeHtml(r.explain)}</div>
    `;
    reviewList.appendChild(div);
  });
}

// 보조: HTML 이스케이프
function escapeHtml(s){
  if(s == null) return '';
  return String(s)
    .replace(/&/g,'&amp;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;')
    .replace(/'/g,'&#39;');
}

</script>
</body>
</html>
